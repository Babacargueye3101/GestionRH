<div class="company-container">
  <mat-toolbar color="primary" class="toolbar">
    <span class="toolbar-title">Gestion des paies</span>
    <span class="spacer"></span>
    <button mat-raised-button color="accent" class="create-button" (click)="creeNewPayment()">
      <mat-icon>add</mat-icon> CrÃ©er des paiements
    </button>
  </mat-toolbar>

  <!-- Nouvelle div pour la table -->
  <div class="payments-table-container">
    <table mat-table [dataSource]="payments" class="mat-elevation-z8">

      <!-- Employee ID Column -->
      <ng-container matColumnDef="employeeId">
        <th mat-header-cell *matHeaderCellDef> EmployÃ© </th>
        <td mat-cell *matCellDef="let payment"> {{payment.employee.first_name}}  {{payment.employee.last_name}}</td>
      </ng-container>

      <!-- Payment Date Column -->
      <ng-container matColumnDef="paymentDate">
        <th mat-header-cell *matHeaderCellDef> Date de paiement </th>
        <td mat-cell *matCellDef="let payment"> {{payment.payment_date | date}} </td>
      </ng-container>

      <!-- Amount Column -->
      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef> Montant </th>
        <td mat-cell *matCellDef="let payment"> {{payment.amount | currency:'FCFA':'symbol':'1.2-2':'fr-FR'}} </td>
      </ng-container>

      <!-- Payment Method Column -->
      <ng-container matColumnDef="paymentMethod">
        <th mat-header-cell *matHeaderCellDef> MÃ©thode de paiement </th>
        <td mat-cell *matCellDef="let payment"> {{payment.payment_method | uppercase}} </td>
      </ng-container>

      <!-- Reference Number Column -->
      <ng-container matColumnDef="referenceNumber">
        <th mat-header-cell *matHeaderCellDef> NumÃ©ro de rÃ©fÃ©rence </th>
        <td mat-cell *matCellDef="let payment"> {{payment.reference_number}} </td>
      </ng-container>

      <!-- Status Column -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef> Statut </th>
        <td mat-cell *matCellDef="let payment"> {{getPaymentStatusViewValue(payment.status)}} </td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef> Actions </th>
        <td mat-cell *matCellDef="let payment">
          <button mat-icon-button [matMenuTriggerFor]="menu">
            <mat-icon>more_vert</mat-icon>
          </button>
          <mat-menu #menu="matMenu">
            <button mat-menu-item (click)="viewPayment(payment.id)">
              <mat-icon>visibility</mat-icon>
              <span>Voir</span>
            </button>
            <button mat-menu-item (click)="editPayment(payment.id)">
              <mat-icon>edit</mat-icon>
              <span>Modifier</span>
            </button>
            <button mat-menu-item (click)="deletePayment(payment.id)">
              <mat-icon>delete</mat-icon>
              <span>Supprimer</span>
            </button>
          </mat-menu>
        </td>
      </ng-container>


      <!-- Header and Row Definitions -->
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;" [ngClass]="{'row-approved': row.status === 'paye'}"></tr>
    </table>
    <mat-paginator [length]="totalPayments"
        [pageSize]="10"
        showFirstLastButtons>
    </mat-paginator>
  </div>
</div>

<ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="medium" color="#fff" type="Ball-Tail">
  <p style="color: white">Veillez patienter un moment  ğŸ˜• !!</p>
</ngx-spinner>
